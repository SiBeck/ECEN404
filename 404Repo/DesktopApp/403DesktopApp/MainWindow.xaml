<Window x:Class="_403DesktopApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="403 Desktop Application" 
        Height="700" Width="1200"
        MinHeight="500" MinWidth="800"
        WindowStartupLocation="CenterScreen">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource PrimaryColor}" Padding="15">
            <TextBlock Text="403 Medical Imaging System" 
                       FontSize="20" 
                       FontWeight="Bold" 
                       Foreground="White"/>
        </Border>

        <!-- Main Content Area with Tabs -->
        <TabControl Grid.Row="1" Margin="10">

            <!-- Home Tab -->
            <TabItem Header="Home">
                <Grid Margin="20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="200"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Navigation Panel -->
                    <Border Grid.Column="0" 
                            Background="{StaticResource SecondaryColor}" 
                            Padding="10" 
                            Margin="0,0,10,0"
                            CornerRadius="5">
                        <StackPanel>
                            <Button Content="Dashboard" 
                                    Command="{Binding NavigateCommand}" 
                                    CommandParameter="Dashboard"
                                    Margin="0,5" 
                                    Padding="10"/>
                            <Button Content="Patients" 
                                    Command="{Binding NavigateCommand}" 
                                    CommandParameter="Patients"
                                    Margin="0,5" 
                                    Padding="10"/>
                            <Button Content="Settings" 
                                    Command="{Binding NavigateCommand}" 
                                    CommandParameter="Settings"
                                    Margin="0,5" 
                                    Padding="10"/>
                        </StackPanel>
                    </Border>

                    <!-- Content Area -->
                    <Border Grid.Column="1" 
                            Background="White" 
                            BorderBrush="#DDDDDD" 
                            BorderThickness="1"
                            CornerRadius="5"
                            Padding="20">
                        <StackPanel>
                            <TextBlock Text="{Binding CurrentPage}" 
                                       FontSize="24" 
                                       FontWeight="Bold"
                                       Margin="0,0,0,20"/>

                            <TextBlock Text="Welcome to 403 Medical Imaging System" 
                                       FontSize="14"
                                       TextWrapping="Wrap"
                                       Margin="0,0,0,20"/>

                            <TextBox Text="{Binding UserInput, UpdateSourceTrigger=PropertyChanged}" 
                                     Width="300" 
                                     HorizontalAlignment="Left"
                                     Margin="0,0,0,10"/>

                            <Button Content="Submit" 
                                    Command="{Binding SubmitCommand}"
                                    Width="100"
                                    HorizontalAlignment="Left"
                                    Padding="10,5"/>

                            <TextBlock Text="{Binding StatusMessage}" 
                                       Margin="0,20,0,0"
                                       FontStyle="Italic"
                                       Foreground="Gray"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- Image Viewer Tab -->
            <TabItem Header="Image Viewer">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Toolbar -->
                    <Border Grid.Row="0" 
                            Background="{StaticResource SecondaryColor}" 
                            Padding="10"
                            BorderBrush="#CCCCCC"
                            BorderThickness="0,0,0,1">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="Open Image" 
                                    Command="{Binding OpenImageCommand}"
                                    Padding="15,8"
                                    Margin="0,0,10,0"
                                    Background="#007ACC"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"/>

                            <Button Content="Clear" 
                                    Command="{Binding ClearImageCommand}"
                                    Padding="15,8"
                                    Margin="0,0,10,0"
                                    Background="#E0E0E0"
                                    BorderThickness="0"
                                    Cursor="Hand"/>

                            <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" 
                                       Margin="10,0"/>

                            <Button Content="Zoom In" 
                                    Command="{Binding ZoomInCommand}"
                                    Padding="15,8"
                                    Margin="0,0,5,0"
                                    Background="#F5F5F5"
                                    BorderThickness="1"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Hand"/>

                            <Button Content="Zoom Out" 
                                    Command="{Binding ZoomOutCommand}"
                                    Padding="15,8"
                                    Margin="0,0,5,0"
                                    Background="#F5F5F5"
                                    BorderThickness="1"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Hand"/>

                            <Button Content="Fit to Screen" 
                                    Command="{Binding FitToScreenCommand}"
                                    Padding="15,8"
                                    Margin="0,0,10,0"
                                    Background="#F5F5F5"
                                    BorderThickness="1"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Hand"/>

                            <TextBlock Text="{Binding ZoomPercentage, StringFormat='{}{0:F0}%'}" 
                                       VerticalAlignment="Center"
                                       Margin="10,0"
                                       FontWeight="SemiBold"/>

                            <!-- Frame Navigation Controls -->
                            <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" 
                                       Margin="10,0"/>

                            <Button Content="|◄" 
                                    Command="{Binding FirstFrameCommand}"
                                    Padding="10,8"
                                    Margin="0,0,5,0"
                                    Background="#F5F5F5"
                                    BorderThickness="1"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Hand"
                                    ToolTip="First Frame (Shift+Left)"/>

                            <Button Content="◄" 
                                    Command="{Binding PreviousFrameCommand}"
                                    Padding="15,8"
                                    Margin="0,0,5,0"
                                    Background="#F5F5F5"
                                    BorderThickness="1"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Hand"
                                    ToolTip="Previous Frame (Left Arrow)"/>

                            <TextBlock Text="{Binding FrameInfo}" 
                                       VerticalAlignment="Center"
                                       Margin="10,0"
                                       MinWidth="100"
                                       TextAlignment="Center"
                                       FontWeight="SemiBold"/>

                            <Button Content="►" 
                                    Command="{Binding NextFrameCommand}"
                                    Padding="15,8"
                                    Margin="0,0,5,0"
                                    Background="#F5F5F5"
                                    BorderThickness="1"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Hand"
                                    ToolTip="Next Frame (Right Arrow)"/>

                            <Button Content="►|" 
                                    Command="{Binding LastFrameCommand}"
                                    Padding="10,8"
                                    Margin="0,0,0,0"
                                    Background="#F5F5F5"
                                    BorderThickness="1"
                                    BorderBrush="#CCCCCC"
                                    Cursor="Hand"
                                    ToolTip="Last Frame (Shift+Right)"/>
                        </StackPanel>
                    </Border>

                    <!-- Image Display Area -->
                    <Border Grid.Row="1" 
                            Background="#2B2B2B"
                            BorderBrush="#CCCCCC"
                            BorderThickness="1">
                        <ScrollViewer HorizontalScrollBarVisibility="Auto" 
                                      VerticalScrollBarVisibility="Auto"
                                      x:Name="ImageScrollViewer">
                            <Canvas Background="Transparent"
                                    MouseWheel="Canvas_MouseWheel"
                                    MouseLeftButtonDown="Canvas_MouseLeftButtonDown"
                                    MouseLeftButtonUp="Canvas_MouseLeftButtonUp"
                                    MouseMove="Canvas_MouseMove">
                                <Image x:Name="DisplayImage"
                                       Source="{Binding CurrentImageSource}"
                                       RenderOptions.BitmapScalingMode="HighQuality"
                                       Stretch="None">
                                    <Image.LayoutTransform>
                                        <ScaleTransform ScaleX="{Binding ZoomLevel}" 
                                                        ScaleY="{Binding ZoomLevel}"/>
                                    </Image.LayoutTransform>
                                </Image>

                                <!-- Markup Canvas (for future annotations) -->
                                <Canvas x:Name="MarkupCanvas" 
                                        Background="Transparent"
                                        Width="{Binding ElementName=DisplayImage, Path=ActualWidth}"
                                        Height="{Binding ElementName=DisplayImage, Path=ActualHeight}">
                                    <Canvas.LayoutTransform>
                                        <ScaleTransform ScaleX="{Binding ZoomLevel}" 
                                                        ScaleY="{Binding ZoomLevel}"/>
                                    </Canvas.LayoutTransform>
                                </Canvas>
                            </Canvas>
                        </ScrollViewer>
                    </Border>

                    <!-- Image Info Bar -->
                    <Border Grid.Row="2" 
                            Background="{StaticResource SecondaryColor}" 
                            Padding="10"
                            BorderBrush="#CCCCCC"
                            BorderThickness="0,1,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0"
                                       Text="{Binding ImageInfo}" 
                                       VerticalAlignment="Center"/>

                            <TextBlock Grid.Column="1"
                                       Text="{Binding ImageDimensions}"
                                       VerticalAlignment="Center"
                                       Margin="20,0,0,0"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

        </TabControl>

        <!-- Status Bar -->
        <Border Grid.Row="2" 
                Background="{StaticResource SecondaryColor}" 
                Padding="10,5">
            <TextBlock Text="{Binding StatusText}" 
                       Foreground="{StaticResource TextColor}"/>
        </Border>
    </Grid>
</Window>